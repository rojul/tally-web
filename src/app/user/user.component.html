<app-nav [backTo]="['/']" [loading]="loading !== 0">
    <div toolbar>
        <button md-icon-button (click)="openEditUserDialog()" [disabled]="editUserDialogRef">
            <md-icon>edit</md-icon>
        </button>
        <button md-icon-button (click)="openRemoveUserDialog()" [disabled]="removeUserDialogRef">
            <md-icon>delete</md-icon>
        </button>
    </div>

    <div class="wrapper">

        <md-card class="info-card" *ngIf="wallet">
            <md-card-title class="alignleft">Hallo {{ wallet.name }}</md-card-title>
            <md-card-title class="alignright">
                Gesamt:
                <euro [value]="wallet.balance"></euro>
            </md-card-title>
            <div style="clear: both; width: 100%; height: 5px;"></div>
            <md-card-subtitle style="width: 100%;">
                <div>Erstellt
                    <time>{{ (wallet.created | amFromUnix) | amTimeAgo }}</time>
                </div>
                <div>Zuletzt aktiv
                    <time>{{ (wallet.active | amFromUnix) | amTimeAgo }}</time>
                </div>
            </md-card-subtitle>
        </md-card>

        <div class="pay-charge" *ngIf="wallet">
            <md-card class="pay-card">
                <md-card-title>Bezahlen</md-card-title>
                <md-card-content class="pay-wrapper">
                    <button md-raised-button *ngFor="let product of products" (click)="newTransaction(product)" [disabled]="!orderActive">
                        <span>{{product.name}}</span>
                        <euro class="secondary" [value]="product.price" [colored]="false"></euro>
                    </button>
                </md-card-content>
            </md-card>

            <md-card class="charge-card" *ngIf="wallet">
                <md-card-title>Aufladen</md-card-title>
                <md-card-content *ngIf="!customChargeShowing" class="charge-wrapper">
                    <button md-raised-button *ngFor="let value of chargeDefaults" (click)="charge(value)" [disabled]="!orderActive">
                        <euro [value]="value" [colored]="false"></euro>
                    </button>
                    <button md-raised-button (click)="toggleCustomRecharge()" [disabled]="!orderActive">
                        <span>?</span>
                    </button>
                </md-card-content>
                <md-card-content *ngIf="customChargeShowing">
                    <euro-input #customRechargeInput [(ngModel)]="customChargeValue" placeholder="Wert"></euro-input>
                </md-card-content>
                <md-card-actions align="end" *ngIf="customChargeShowing">
                    <button md-button color="primary" (click)="toggleCustomRecharge()">ABBRECHEN</button>
                    <button md-raised-button color="accent" [disabled]="!customChargeValue" (click)="customCharge()">OK</button>
                </md-card-actions>
            </md-card>
        </div>

        <md-card class="transactions-card" *ngIf="wallet">
            <md-card-title>
                Letzte Transaktionen
            </md-card-title>
            <md-card-content>
                <md-list dense>
                    <md-list-item *ngFor="let transaction of wallet.transactions">
                        <h3 md-line>
                            <euro [value]="transaction.value"></euro>
                        </h3>
                        <span md-line class="secondary"><time>{{ (transaction.created | amFromUnix) | amTimeAgo }}</time></span>
                        <button md-icon-button (click)="deleteTransaction(transaction.id)">
                            <md-icon>delete</md-icon>
                        </button>
                    </md-list-item>
                    <md-list-item *ngIf="wallet.transactions.length == 0">
                        <span md-line class="secondary"><md-card-subtitle>Noch keine Transaktionen</md-card-subtitle></span>
                    </md-list-item>
                </md-list>
            </md-card-content>
            <md-card-actions align="end">
                <button md-button [routerLink]="[ '/users', wallet.id, 'transactions'] ">MEHR</button>
            </md-card-actions>
        </md-card>
    </div>
</app-nav>
<app-idle-redirector></app-idle-redirector>